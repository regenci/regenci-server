datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialActions"]
}

enum LogActionTypes {
  login
  logout
  signup
  reset_password
  added_provider
  added_password
  forgot_password
  removed_password
}

model User {
  id                String   @id @default(uuid())
  /// Account first name
  first_name        String
  /// Account last name
  last_name         String
  /// Account email address
  email_address     String   @unique
  /// Account password, optional if registered a provider
  password          String?
  /// Account password salt, optional if there is no password
  password_salt     String?
  /// Verification code, used to activate account if registered using credentials
  verification_code Int?
  /// Account picture, optional if registered using credentials
  profile_picture   String?
  /// Provider id, optional if registered using credentials
  provider_id       String?
  /// Provider name, optional if registered using credentials
  provider_name     String?
  /// Account resume templates used
  used_templates    String[]
  /// Account security logs
  logs              Logs[]
  /// This relation contains the user data for the resume
  resume            Resume?  @relation(fields: [resume_id], references: [id])
  updated_at        DateTime @updatedAt
  created_at        DateTime @default(now())
  /// Used to verify if the account has admin role, required only for the admin dashboard
  is_admin          Boolean  @default(false)
  /// Used to verify if the account has been activated, required only for credentials signup
  is_verified       Boolean  @default(false)
  resume_id         String?
}

model Logs {
  id                String         @id @default(uuid())
  action_type       LogActionTypes
  action_date       DateTime       @default(now())
  action_ip_address String
  action_location   String
  User              User?          @relation(fields: [user_id], references: [id], onDelete: Cascade)
  user_id           String?
}

model Resume {
  id                   String       @id @default(uuid())
  email_address        String?
  first_name           String?
  last_name            String?
  profile_picture      String?
  job_title            String?
  phone_number         String?
  full_address         String?
  professional_summary String?
  date_of_birth        DateTime?
  education            Education[]
  experience           Experience[]
  languages            Language[]
  skills               Skill[]
  links                Link[]
  hobbies              Hobby[]
  references           Reference[]
  User                 User[]
}

model Education {
  id                     String   @id @default(uuid())
  institution_name       String
  institution_degree     String
  institution_start_date DateTime
  institution_end_date   DateTime
  Resume                 Resume?  @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id              String?
}

model Experience {
  id                     String   @id @default(uuid())
  experience_company     String
  experience_job_title   String
  experience_start_date  DateTime
  experience_end_date    DateTime
  experience_description String?
  Resume                 Resume?  @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id              String?
}

model Language {
  id             String  @id @default(uuid())
  language_title String
  language_level Int     @default(0)
  Resume         Resume? @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id      String?
}

model Skill {
  id          String  @id @default(uuid())
  skill_title String
  skill_level Int?    @default(0)
  Resume      Resume? @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id   String?
}

model Link {
  id         String  @id @default(uuid())
  link_title String
  link_url   String
  Resume     Resume? @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id  String?
}

model Hobby {
  id          String  @id @default(uuid())
  hobby_title String
  Resume      Resume? @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id   String?
}

model Reference {
  id                     String  @id @default(uuid())
  referent_full_name     String
  referent_company_name  String
  referent_phone_number  String
  referent_email_address String
  Resume                 Resume? @relation(fields: [resume_id], references: [id], onDelete: Cascade)
  resume_id              String?
}

// A resume template (part of admin dashboard)
model Template {
  id                String   @id @default(uuid())
  title             String
  preview_image_url String
  jsx_code          String
  author_id         String
  use_count         Int      @default(0)
  updated_at        DateTime @updatedAt
  created_at        DateTime @default(now())
}
